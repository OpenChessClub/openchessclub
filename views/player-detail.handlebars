<div class="px-4 py-6 sm:px-0">
  <div class="mb-6">
    <a href="/" class="text-blue-600 hover:text-blue-800 text-sm">&larr; Home</a>
  </div>

  <div class="bg-white shadow rounded-lg overflow-hidden mb-6">
    <div class="px-6 py-5 border-b border-gray-200 flex justify-between items-start">
      <div>
        <h1 class="text-3xl font-bold text-gray-900">{{player.name}}</h1>
        <div class="mt-2 flex items-center space-x-4">
          {{#if player.active}}
          <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
            Active
          </span>
          {{else}}
          <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-gray-100 text-gray-800">
            Inactive
          </span>
          {{/if}}
          {{#if player.email}}
          <span class="text-sm text-gray-500">{{player.email}}</span>
          {{/if}}
        </div>
      </div>

      {{#if user}}
        {{#if (eq user.role 'admin')}}
            <a href="/players/{{player.slug}}/edit" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium">
                Edit Player
            </a>
        {{/if}}
      {{/if}}
      
    </div>

    <div class="grid grid-cols-2 md:grid-cols-4 gap-4 p-6 text-center">
      <div>
        <dt class="text-sm font-medium text-gray-500">Current Rating</dt>
        <dd class="mt-1 text-3xl font-semibold {{player.current_rating}}">{{player.current_rating}}</dd>
      </div>
      <div>
        <dt class="text-sm font-medium text-gray-500">Peak Rating</dt>
        <dd class="mt-1 text-3xl font-semibold text-gray-900">{{player.peak_rating}}</dd>
      </div>
      <div>
        <dt class="text-sm font-medium text-gray-500">Games Played</dt>
        <dd class="mt-1 text-3xl font-semibold text-gray-900">{{player.games_played}}</dd>
      </div>
      <div>
        <dt class="text-sm font-medium text-gray-500">Win Rate</dt>
        <dd class="mt-1 text-3xl font-semibold text-gray-900">{{winPercentage}}%</dd>
      </div>
    </div>

    <div class="border-t border-gray-200 px-6 py-4">
      <div class="flex justify-center text-center gap-12">
        <div class="space-y-0.5">
          <div class="text-2xl font-bold text-green-600 leading-tight">{{player.wins}}</div>
          <div class="text-xs text-gray-500">Wins</div>
        </div>
        <div class="space-y-0.5">
          <div class="text-2xl font-bold text-red-600 leading-tight">{{player.losses}}</div>
          <div class="text-xs text-gray-500">Losses</div>
        </div>
        <div class="space-y-0.5">
          <div class="text-2xl font-bold text-gray-600 leading-tight">{{player.draws}}</div>
          <div class="text-xs text-gray-500">Draws</div>
        </div>
      </div>
    </div>

    <div class="border-t border-gray-200 px-6 py-4 bg-gray-50 flex justify-between items-center">
      <div class="text-sm text-gray-500">
        <span class="font-medium">Joined:</span> {{formatDate player.createdAt}}
      </div>

      <div class="flex items-center space-x-4">
        {{#if player.lichess}}
          <a href="https://lichess.org/@/{{player.lichess}}" target="_blank" rel="noopener noreferrer"
            class="flex items-center space-x-1 text-gray-600 hover:text-black transition">
            <img src="/lichess_svg.svg"
                alt="Lichess" class="h-5 w-5">
            <span class="hidden sm:inline">Lichess</span>
          </a>
        {{/if}}

        {{#if player.chesscom}}
          <a href="https://www.chess.com/member/{{player.chesscom}}" target="_blank" rel="noopener noreferrer"
            class="flex items-center space-x-1 text-gray-600 hover:text-black transition">
            <img src="/chesscom.png"
                alt="Chess.com" class="h-5 w-5 object-contain rounded-sm" style="aspect-ratio: 1 / 1;">
            <span class="hidden sm:inline">Chess.com</span>
          </a>
        {{/if}}
      </div>
    </div>

  </div>

  <div class="bg-white shadow rounded-lg overflow-hidden">
    <div class="px-6 py-5 border-b border-gray-200">
      <h2 class="text-xl font-bold text-gray-900">Game History</h2>
    </div>

    {{#if games}}
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Color</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Opponent</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Result</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rating</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Change</th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          {{#each games}}
          <tr class="hover:bg-gray-50">
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{{formatDate played_at}}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm">
              {{#if (eq playerColor 'white')}}
              <span class="text-gray-800">White</span>
              {{else}}
              <span class="text-gray-600">Black</span>
              {{/if}}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm">
              <a href="/players/{{#if (eq playerColor 'white')}}{{black_player.slug}}{{else}}{{white_player.slug}}{{/if}}" class="text-blue-600 hover:text-blue-800">
                {{opponent}}
              </a>
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm">
              {{#if (eq result 'white_win')}}
                {{#if (eq playerColor 'white')}}
                <span class="font-semibold text-green-600">Won</span>
                {{else}}
                <span class="font-semibold text-red-600">Lost</span>
                {{/if}}
              {{else if (eq result 'black_win')}}
                {{#if (eq playerColor 'black')}}
                <span class="font-semibold text-green-600">Won</span>
                {{else}}
                <span class="font-semibold text-red-600">Lost</span>
                {{/if}}
              {{else}}
                <span class="font-semibold text-gray-600">Draw</span>
              {{/if}}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
              {{playerRatingBefore}} â†’ {{playerRatingAfter}}
            </td>
            <td class="px-6 py-4 whitespace-nowrap text-sm">
              {{#if (positiveChange playerRatingChange)}}
              <span class="text-green-600 font-semibold">+{{playerRatingChange}}</span>
              {{else}}
              <span class="text-red-600 font-semibold">{{playerRatingChange}}</span>
              {{/if}}
            </td>
          </tr>
          {{/each}}
        </tbody>
      </table>
    </div>
    {{else}}
    <div class="px-6 py-12 text-center">
      <div class="text-gray-400">
        <svg class="mx-auto h-12 w-12" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
        </svg>
        <p class="mt-2 text-sm text-gray-500">No games recorded yet</p>
      </div>
    </div>
    {{/if}}
  </div>
</div>
